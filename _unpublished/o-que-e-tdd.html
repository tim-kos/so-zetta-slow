<p>Comecei a mexer com JavaScript em julho de 2010, por causa do que veio a ser o <a href="http://www.mojambo.net">Mojambo</a>. Naquele tempo, meu background em programação eram o curso de C que tive na Poli (de 6 meses) e MATLAB. Ou seja, fiz meia dúzia de scripts ruins sem saber exatamente o que estava fazendo.</p>

<p>Em alguns meses, resolvi aprender programação igual gente. Comprei <a href="http://www.onox.com.br/" target="_blank">livros</a>, escrevi (e reescrevi) programas, fui atrás de completar projetinhos pessoais. Hoje quero falar sobre um dos frutos deste estudo, que é o uso de <b>Test-Driven Development (TDD)</b> em JavaScript com o JsTestDriver.</p>

<h3>O que é TDD?</h3>

<p>Test-Driven Development (TDD) é uma forma de programar onde testes são escritos antes de se escrever o código propriamente dito. Dessa forma, os testes servem como uma especificação do comportamento que se espera do código: o objetivo do programa torna-se mais claro e é quase impossível escrever módulos acoplados (que dependem demais uns dos outros). Isso resulta em um programa muito mais fácil de se entender, tanto pelo desenvolvedor quanto por outra pessoa que vá ler o código. E esses testes são automáticos e <b>rápidos</b>, permitindo que sejam executados após cada mudança no código, por menor que seja.</p>

<p>Existem outros dois benefícios que eu senti na pele depois de me acostumar com o JsTestDriver: a confiança de fazer mudanças e saber imediatamente se isso gerou algum bug e a maravilhosa sensação de descobrir problemas e fazer os testes passarem. Meu primeiro programa escrito desde o início com TDD foi a versão 2.0 da <a href="http://www.github.com/agarie/damagecalc" target="_blank">damageCalc</a>, onde em muitos momentos a necessidade de subdividir um método tornava-se óbvia e que praticamente não tive bugs desde que terminei o código, tendo-os corrigido durante o desenvolvimento.</p>

<h3>Mas como funciona?</h3>

<p>Escreva um teste. Rode a suíte de testes e veja ele falhar. Escreva o comportamento mínimo (ou seja, vale usar alguma gambiarra) que faz o teste passar. Depois, pode-se melhorar o código. Esse é o processo descrito e adotado pela maioria dos <a href="http://www.onox.com.br/" target="_blank">livros</a>/tutoriais sobre TDD que eu li e é o que usei para escrever a segunda versão da minha <a href="http://www.github.com/agarie/damagecalc" target="_blank">calculadora de dano para Pokémon</a>, entre outros programas.</p>

<p>A suíte de testes é apenas código que exercita aquilo que você escreveu, possibilitando a automatização dos testes. Para escrevê-la, é bom se utilizar de alguma biblioteca feita para isso, como é o caso do JsTestDriver. Com ele, você pode escrever algo assim:</p>

<code>
	TestCase("CalculatorTest", function () {
		"test division should return number": function () {
			assertNumber(division(100, 20));
		},
		
		"test division should return correct value": function () {
			assertEquals(5, division(100, 20));
		}
	});
</code>

<p>Dessa forma, podemos rodar um comando no Terminal e ver o resultado.</p>

<!-- Colocar o resultado de se rodar o JsTestDriver no Terminal -->

<!-- Dar o link da bundle de TextMate para o JsTestDriver -->

<!-- Dar o link para o post sobre como instalar e usar o JsTestDriver -->